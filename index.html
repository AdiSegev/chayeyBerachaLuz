<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>יצירת לוח זמנים - חיי ברכה</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Hebrew:wght@400;700&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body dir="rtl" class="container" onload="initializePage()">

    <header class="text-center mt-4 mb-5">
        <h1 class="display-4 text-primary">יצירת לוח זמנים לחגים</h1>
        <p class="lead text-secondary">אנא הזן את היום בו חל החג ואת זמן השקיעה על מנת לייצר את לוח הזמנים</p>
    </header>

    <div class="card shadow-lg">
        <div class="card-body">
            <form id="prayer-times-form" class="mt-3">
                <div class="mb-4">
                    <label for="hebrew-year" class="form-label fw-bold">בחר שנה עברית:</label>
                    <div class="position-relative">
                        <input type="text" id="hebrew-year" class="form-control" placeholder="הקלד או בחר שנה עברית..." autocomplete="off">
                        <div id="hebrew-years-dropdown" class="dropdown-menu w-100" style="max-height: 200px; overflow-y: auto; display: none;">
                            <!-- השנים יוטענו אוטומטית דרך JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="holiday" class="form-label fw-bold">בחר חג:</label>
                    <select id="holiday" name="holiday" class="form-select">
                        <option value="rosh_hashana">ראש השנה</option>
                        <option value="yom_kippur">יום כיפור</option>
                        <option value="sukkot">סוכות</option>
						<option value="shabat_chol_hamoed_sukkot">שבת חול המועד סוכות</option>
                        <option value="simchat_torah">שמחת תורה</option>
                        <option value="pesach">פסח</option>
						<option value="shabat_chol_hamoed_pesach">שבת חול המועד פסח</option>
                        <option value="shvii_pesach">שביעי של פסח</option>
                        <option value="shavuot">שבועות</option>
                        <option value="tisha_beav">תשעה באב</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="day-of-week" class="form-label fw-bold">בחר יום בשבוע:</label>
                    <select id="day-of-week" name="day-of-week" class="form-select">
                        <option value="sunday">ראשון</option>
                        <option value="monday">שני</option>
                        <option value="tuesday">שלישי</option>
                        <option value="wednesday">רביעי</option>
                        <option value="thursday">חמישי</option>
                        <option value="friday">שישי</option>
                        <option value="saturday">שבת</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="sunset-time" class="form-label fw-bold">הכנס שעת שקיעה:</label>
                    <input type="time" id="sunset-time" class="form-control" required>
                </div>

                <div class="row mb-3">
                    <div class="col">
                        <button type="button" class="btn btn-primary w-100 fw-bold" onclick="generateWordDocument()">צור מסמך Word</button>
                    </div>
                    <div class="col">
                        <button type="button" class="btn btn-success w-100 fw-bold" onclick="openEditModal()">עריכה ויצירת תמונה</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal עריכת זמני תפילה -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white position-relative">
                    <button type="button" class="btn-close btn-close-white position-absolute" style="left: 15px; top: 50%; transform: translateY(-50%);" data-bs-dismiss="modal" aria-label="Close"></button>
                    <h5 class="modal-title w-100 text-center" id="editModalLabel">
                        <i class="fas me-2"></i>עריכת זמני תפילה
                    </h5>
                </div>
                <div class="modal-body p-4">
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="card h-100">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0 text-primary">
                                        <i class="fas me-2"></i>עריכת זמנים
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="editTable"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card h-100">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0 text-success">
                                        <i class="fas me-2"></i>תצוגה מקדימה
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="previewContainer" style="height: auto; min-height: 400px; overflow: visible;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas me-2"></i>ביטול
                    </button>
                    <button type="button" class="btn btn-primary" onclick="generateWordFromEdited()" data-bs-dismiss="modal">
                        <i class="fas fa-file-word me-2"></i>ייצא ל-Word
                    </button>
                    <button type="button" class="btn btn-success" onclick="generateFinalImageFromEdited()" data-bs-dismiss="modal">
                        <i class="fas fa-image me-2"></i>צור תמונה
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-body text-center p-5">
                    <div class="loading-spinner mb-4">
                        <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
                            <span class="visually-hidden">טוען...</span>
                        </div>
                    </div>
                    <h5 class="text-primary mb-3">טוען זמני תפילה</h5>
                    <p class="text-muted mb-0">משיכת נתונים מ-Hebcal...</p>
                    <div class="progress mt-3" style="height: 8px;">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center mt-5">
        <p class="text-muted">&copy; 2024 - אפליקציית לוח זמנים לחגים יהודים</p>
    </footer>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
	<script src="https://unpkg.com/kosher-zmanim@0.8.2/dist/kosher-zmanim.min.js"></script>
    <script src="script.js"></script>
    <script src="edit_functions.js"></script>
	<script src="rosh_hashana.js"></script>
	<script src="yom_kippur.js"></script>
	<script src="sukkot.js"></script>
	<script src="shabat_chol_hamoed_sukkot.js"></script>
	<script src="simchat_torah.js"></script>
	<script src="pesach.js"></script>
	<script src="shvii_pesach.js"></script>
	<script src="shabat_chol_hamoed_pesach.js"></script>
	<script src="shavuot.js"></script>
    <script src="tisha_beav.js"></script>
    </body>
</html>